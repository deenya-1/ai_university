Считаю, что выполнять все операции за O(1) невозможно.
Нам придется выбирать - либо ставлять новые элементы в конец массива за O(1),но проходить массив, чтобы найти мин и макс элемент для удаления.
Либо сортировать после ставки, но зато удалять мин и макс за O(1), т.к. мин - всегда первый элемент, а макс - последний.